!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),s=n(37),a=r(s),u=n(38),c=r(u),f=n(42),d=n(43),l=n(44),y=r(l),h=n(45),p=r(h),v=void 0,g=!1,b=function(){function e(t,n,r){(0,a.default)(this,e),r=r||n.options_,t.src&&(this.el_=n.el(),this.player_=videojs(r.playerId),this.protection_=t&&t.protection,this.tech_=n,this.onCertificateError=this.onCertificateError.bind(this),this.onCertificateLoad=this.onCertificateLoad.bind(this),this.onKeySessionWebkitKeyAdded=this.onKeySessionWebkitKeyAdded.bind(this),this.onKeySessionWebkitKeyError=this.onKeySessionWebkitKeyError.bind(this),this.onKeySessionWebkitKeyMessage=this.onKeySessionWebkitKeyMessage.bind(this),this.onLicenseError=this.onLicenseError.bind(this),this.onLicenseLoad=this.onLicenseLoad.bind(this),this.onVideoError=this.onVideoError.bind(this),this.onVideoWebkitNeedKey=this.onVideoWebkitNeedKey.bind(this),this.waitForOnVideoWebkitNeedKey=!0,n.isReady_=!1,this.src(t),n.triggerReady())}return(0,c.default)(e,null,[{key:"setLogToBrowserConsole",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g=e}}]),(0,c.default)(e,[{key:"createKeySession",value:function(e,t){if(this.log("createKeySession()"),!this.el_.webkitKeys){if(!WebKitMediaKeys.isTypeSupported(e,"video/mp4"))throw new Error("Key System not supported");this.el_.webkitSetMediaKeys(new WebKitMediaKeys(e))}if(!this.el_.webkitKeys)throw new Error("Could not create MediaKeys");var n=this.el_.webkitKeys.createSession("video/mp4",t);if(!n)throw new Error("Could not create key session");return n}},{key:"fetchCertificate",value:function(e){var t=this,n=e.callback;this.log("fetchCertificate()");var r=this.protection_.certificateUrl,i=new XMLHttpRequest;i.responseType="text",i.addEventListener("error",this.onCertificateError,!1),i.addEventListener("load",function(e){t.onCertificateLoad(e,{callback:n})},!1),i.open("GET",r,!0),i.setRequestHeader("Pragma","Cache-Control: no-cache"),i.setRequestHeader("Cache-Control","max-age=0"),i.send()}},{key:"fetchLicense",value:function(e){var t=e.target,n=e.message;this.log("fetchLicense()");var r=this.protection_,i=r.licenseUrl,s=r.licenseRequestHeaders,a=(0,o.default)(s)[0],u=s[a],c=new XMLHttpRequest;c.responseType="text",c.session=t,c.addEventListener("error",this.onLicenseError,!1),c.addEventListener("load",this.onLicenseLoad,!1),this.log("spc="+(0,f.base64EncodeUint8Array)(n));var d="spc="+(0,f.base64EncodeUint8Array)(n)+"&assetId="+encodeURIComponent(c.session.contentId);c.open("POST",i,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.setRequestHeader(a,u),c.send(d)}},{key:"getErrorResponse",value:function(e){return e?String.fromCharCode.apply(null,new Uint8Array(e)):"NONE"}},{key:"hasProtection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.certificateUrl,n=e.keySystem,r=e.licenseUrl;return this.log("hasProtection()"),t&&n&&r}},{key:"log",value:function(){var e;g&&(e=console).log.apply(e,arguments)}},{key:"onCertificateError",value:function(){this.log("onCertificateError()"),this.player_.error({code:0,message:"Failed to retrieve the server certificate."})}},{key:"onCertificateLoad",value:function(e,t){var n=t.callback;this.log("onCertificateLoad()");var r=e.target,i=r.response,o=r.status;return 200!==o?void this.onRequestError(e.target,y.default.FETCH_CERTIFICATE):(v=(0,f.base64DecodeUint8Array)(i),this.log(i),n(),this.el_.addEventListener("webkitneedkey",this.onVideoWebkitNeedKey,!1),void this.el_.addEventListener("error",this.onVideoError,!1))}},{key:"onRequestError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.default.UNKNOWN;this.log("onRequestError()");var n=t+" - DRM: com.apple.fps.1_0 update,\n      XHR status is '"+e.statusText+"("+e.status+")', expected to be 200.\n      readyState is '"+e.readyState+"'.\n      Response is "+this.getErrorResponse(e.response);this.player_.error({code:0,message:n})}},{key:"onKeySessionWebkitKeyAdded",value:function(){this.log("onKeySessionWebkitKeyAdded()"),this.log("Decryption key was added to the session.")}},{key:"onKeySessionWebkitKeyError",value:function(){this.log("onKeySessionWebkitKeyError()"),this.player_.error({code:0,message:"A decryption key error was encountered."})}},{key:"onKeySessionWebkitKeyMessage",value:function(e){this.log("onKeySessionWebkitKeyMessage()");var t=e.message,n=e.target;this.fetchLicense({message:t,target:n})}},{key:"onLicenseError",value:function(){this.log("onLicenseError()"),this.player_.error({code:0,message:"The license request failed."})}},{key:"onLicenseLoad",value:function(e){this.log("onLicenseLoad()"),this.log(e.target);var t=e.target,n=t.response,r=t.session,i=t.status;return 200!==i?void this.onRequestError(e.target,y.default.FETCH_LICENCE):void r.update((0,f.base64DecodeUint8Array)(n.trim()))}},{key:"onVideoError",value:function(){this.log("onVideoError()"),this.player_.error({code:0,message:"A video playback error occurred."})}},{key:"onVideoWebkitNeedKey",value:function(e){var t=this;this.log("onVideoWebkitNeedKey()"),!p.default.isMobileDevice()&&p.default.isSafari()?this.waitForOnVideoWebkitNeedKey?(this.waitForOnVideoWebkitNeedKey=!1,this.waitForOnVideoWebkitNeedKeyTm=setTimeout(function(n){t.resumeCreateKeySession(e)},500)):(clearTimeout(this.waitForOnVideoWebkitNeedKeyTm),this.resumeCreateKeySession(e)):this.resumeCreateKeySession(e)}},{key:"resumeCreateKeySession",value:function(e){var t=this.protection_.keySystem,n=(0,d.extractContentId)(e.initData),r=(0,d.concatInitDataIdAndCertificate)(e.initData,n,v),i=this.createKeySession(t,r);i.contentId=n,i.addEventListener("webkitkeyadded",this.onKeySessionWebkitKeyAdded,!1),i.addEventListener("webkitkeyerror",this.onKeySessionWebkitKeyError,!1),i.addEventListener("webkitkeymessage",this.onKeySessionWebkitKeyMessage,!1)}},{key:"src",value:function(e){var t=this,n=e.src;return this.hasProtection(this.protection_)?(this.el_.addEventListener("webkitneedkey",this.onVideoWebkitNeedKey,!1),v?void this.tech_.src(n):void this.fetchCertificate({callback:function(){t.tech_.src(n)}})):void this.tech_.src(n)}}]),e}();videojs.fairplaySourceHandler=function(){return{canHandleSource:function(e){if(!window.WebKitMediaKeys)return"";var t=e&&e.protection&&e.protection.keySystem,n=WebKitMediaKeys.isTypeSupported(t,"video/mp4");return n?"probably":""},handleSource:function(e,t,n){return new b(e,t,n)},canPlayType:function(e){return videojs.fairplaySourceHandler.canPlayType(e)}}},videojs.fairplaySourceHandler.canPlayType=function(e){var t=/application\/x-mpegURL/i;return t.test(e)?"maybe":""},videojs.getComponent("Html5").registerSourceHandler(videojs.fairplaySourceHandler(),-1),videojs.Html5Fairplay=b,t.default=b},function(e,t,n){e.exports={default:n(2),__esModule:!0}},function(e,t,n){n(3),e.exports=n(18).Object.keys},function(e,t,n){var r=n(4),i=n(6);n(23)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(5);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(7),i=n(22);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(8),i=n(9),o=n(12)(!1),s=n(16)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>u;)r(a,n=t[u++])&&(~o(c,n)||c.push(n));return c}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(10),i=n(5);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(11);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(9),i=n(13),o=n(15);e.exports=function(e){return function(t,n,s){var a,u=r(t),c=i(u.length),f=o(s,c);if(e&&n!=n){for(;c>f;)if(a=u[f++],a!=a)return!0}else for(;c>f;f++)if((e||f in u)&&u[f]===n)return e||f||0;return!e&&-1}}},function(e,t,n){var r=n(14),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(14),i=Math.max,o=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(17)("keys"),i=n(21);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(18),i=n(19),o="__core-js_shared__",s=i[o]||(i[o]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(20)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=!0},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(24),i=n(18),o=n(33);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*o(function(){n(1)}),"Object",s)}},function(e,t,n){var r=n(19),i=n(18),o=n(25),s=n(27),a=n(8),u="prototype",c=function(e,t,n){var f,d,l,y=e&c.F,h=e&c.G,p=e&c.S,v=e&c.P,g=e&c.B,b=e&c.W,k=h?i:i[t]||(i[t]={}),E=k[u],w=h?r:p?r[t]:(r[t]||{})[u];h&&(n=t);for(f in n)d=!y&&w&&void 0!==w[f],d&&a(k,f)||(l=d?w[f]:n[f],k[f]=h&&"function"!=typeof w[f]?n[f]:g&&d?o(l,r):b&&w[f]==l?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[u]=e[u],t}(l):v&&"function"==typeof l?o(Function.call,l):l,v&&((k.virtual||(k.virtual={}))[f]=l,e&c.R&&E&&!E[f]&&s(E,f,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(26);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(28),i=n(36);e.exports=n(32)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(29),i=n(31),o=n(35),s=Object.defineProperty;t.f=n(32)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(30);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(32)&&!n(33)(function(){return 7!=Object.defineProperty(n(34)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){e.exports=!n(33)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(30),i=n(19).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(30);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(39),o=r(i);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){e.exports={default:n(40),__esModule:!0}},function(e,t,n){n(41);var r=n(18).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(24);r(r.S+r.F*!n(32),"Object",{defineProperty:n(28).f})},function(e,t){"use strict";function n(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}function r(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}function i(e){for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}function o(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=void 0,r=void 0,i=void 0,o=void 0,s=void 0,a=void 0,u=void 0,c=0,f="";c<e.length;)n=e[c++],r=c<e.length?e[c++]:Number.NaN,i=c<e.length?e[c++]:Number.NaN,o=n>>2,s=(3&n)<<4|r>>4,a=(15&r)<<2|i>>6,u=63&i,isNaN(r)?a=u=64:isNaN(i)&&(u=64),f+=t.charAt(o)+t.charAt(s)+t.charAt(a)+t.charAt(u);return f}Object.defineProperty(t,"__esModule",{value:!0}),t.stringToArray=n,t.arrayToString=r,t.base64DecodeUint8Array=i,t.base64EncodeUint8Array=o},function(e,t,n){"use strict";function r(e,t,n){"string"==typeof t&&(t=(0,o.stringToArray)(t));var r=e.byteLength+4+t.byteLength+4+n.byteLength,i=0,s=new ArrayBuffer(r),a=new DataView(s),u=new Uint8Array(s,i,e.byteLength);u.set(e),i+=u.byteLength,a.setUint32(i,t.byteLength,!0),i+=4;var c=new Uint16Array(s,i,t.length);c.set(t),i+=c.byteLength,a.setUint32(i,n.byteLength,!0),i+=4;var f=new Uint8Array(s,i,n.byteLength);return f.set(n),new Uint8Array(s,0,s.byteLength)}function i(e){var t=(0,o.arrayToString)(e);return t.substring(t.indexOf("skd://")+6)}Object.defineProperty(t,"__esModule",{value:!0}),t.concatInitDataIdAndCertificate=r,t.extractContentId=i;var o=n(42)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={FETCH_CERTIFICATE:"FETCH CERTIFICATE",FETCH_LICENCE:"FETCH LICENCE",UNKNOWN:"UNKNOWN"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),o=r(i),s=n(38),a=r(s),u=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"isMobileDevice",value:function(e){var t=["Android","webOS","iPhone","iPod","BlackBerry","IEMobile","Opera Mini"];return"undefined"!=typeof e&&(t=t.concat(e)),new RegExp(t.join("|"),"i").test(navigator.userAgent)||this.isIosWithMultiTouchPoint()||this.isMobileSamsungBrowser()}},{key:"isIosWithMultiTouchPoint",value:function(){return new RegExp("(Macintosh)","i").test(navigator.userAgent)&&navigator.maxTouchPoints>0}},{key:"isMobileSamsungBrowser",value:function(){return new RegExp("(SamsungBrowser)","i").test(navigator.userAgent)&&navigator.maxTouchPoints>0}},{key:"isMobileDeviceWithIPad",value:function(){return this.isMobileDevice(["iPad"])}},{key:"isIos",value:function(){return new RegExp("iPhone|iPad","i").test(navigator.userAgent)||this.isIosWithMultiTouchPoint()}},{key:"isMac",value:function(){return new RegExp("Macintosh","i").test(navigator.userAgent)&&0==navigator.maxTouchPoints}},{key:"isIE",value:function(){return navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident/")>=0}},{key:"isSafari",value:function(){return navigator.userAgent.toLowerCase().indexOf("safari/")>=0}},{key:"isSupportHTML5Video",value:function(){try{var e=document.createElement("video");return e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')}catch(e){return!1}}},{key:"isSupportMSE",value:function(e){try{return MediaSource.isTypeSupported(e),!0}catch(e){return!1}}},{key:"getChromeVersion",value:function(){var e=navigator.userAgent.match(/.*Chrome\/([0-9]+)/);return e?parseInt(e[1],10):null}},{key:"getFirefoxVersion",value:function(){var e=navigator.userAgent.match(/.*Firefox\/([0-9]+)/);return e?parseInt(e[1],10):null}}]),e}();t.default=u}])});