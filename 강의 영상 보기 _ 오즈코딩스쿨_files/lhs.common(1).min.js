function LhsCommon(){const e=this;e.field={csrf:"",isLogin:null,payload:{}},e.navi=function(){var e=$(window),n=$(document),t=$("body, html"),i=($("#lhs_header"),$(".indicator li")),l=$("#jlcContainer > section");l.length,t.is(".main_body");this.index=0,this.idx=1,this.heightArr=[],this.topArr=[];var o=this;function a(){o.topArr=[],o.heightArr=[],l.each((function(){o.topArr.push($(this).position().top),o.heightArr.push($(this).height())}))}function s(){var n=e.scrollTop(),l=0;for(o.topArr[l-1];n>=o.topArr[l];)l++;o.idx=l-1,i.eq(o.idx).addClass("on").siblings().removeClass("on"),e.scrollTop()>o.topArr[3]+841?(t.addClass("topCase1"),e.scrollTop()>o.topArr[3]+1286?t.addClass("topCase2"):t.removeClass("topCase2")):t.removeClass("topCase1 topCase2")}return this.goSection=function(e){!0,t.stop().animate({scrollTop:o.topArr[e]+"px"},{duration:1e3,easing:"easeOutCubic",complete:function(){!1,o.idx=e}})},a(),e.resize(a),n.on("click",".indicator li",(function(e){e.preventDefault();var n=$(this);console.log(o),o.goSection(n.index())})).on("click",".btn_top",(function(e){e.preventDefault(),t.is(".topCase1")?o.goSection(0):o.goSection(o.idx+1)})),e.scroll(s),this},e.resizer=function(){var e=$(window),n=$(".window"),t=function(){return window.innerHeight>900?window.innerHeight:900};function i(){var i=t();window.sectionH=parseInt(i),n.css("height",i),e.width()<1440?$(".box_apply").addClass("narrow"):$(".box_apply").removeClass("narrow")}i(),e.resize(i)},e.slider={kv:function(){$().slick instanceof Function&&$(".kv_slide").slick({dots:!1,arrows:!1,autoplay:!0,fade:!0,pauseOnHover:!1,speed:3e3})},ed:function(){$(".slick_slider").each((function(){var e=$(this),n=e.attr("dataCnt")?parseInt(e.attr("dataCnt")):4;$().slick instanceof Function&&e.slick({dots:!1,arrows:!0,autoplay:!1,pauseOnHover:!1,speed:1e3,slidesToShow:n,slidesToScroll:1,centerPadding:0,zIndex:5,prevArrow:"<div class='slick_prev'></div>",nextArrow:"<div class='slick_next'></div>",responsive:[{breakpoint:992,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:576,settings:{slidesToShow:1,slidesToScroll:1}}]})}))}},e.developedBy=()=>{console.log("Developed By,,, CheolWoong Choi"),console.log("Since 2019. 11~")},e.Modal=function(){this.el="",this.openBtn="",this.firFocus="",this.lastFocus="",this.scrollY="",this.getAddClass="",this.type=1;this.open=function(e,n,t,i){this.scrollY=window.pageYOffset||document.documentElement.scrollTop||window.scrollY,this.el="#"+e,this.openBtn=n,$(".popup_team").hide(),$(this.el).show(),0==t||$("body").addClass("fixed").css("top",-this.scrollY+"px"),this.firFocus=$(this.el).find(".modal_fir_focus"),this.lastFocus=$(this.el).find(".modal_las_focus"),this.firFocus.focus(),this.type="team","team"==this.type&&$(this.el).parent(".dim_team").addClass("popup_on"),this.close(),this.loop()},this.close=function(){var e=this;$(this.el).find(".modal_btn_close").click((function(){$(e.el).hide(),$("body").removeClass("fixed"),$(window).scrollTop(e.scrollY),"team"==e.type&&$(e.el).parent(".dim_team").removeClass("popup_on")}))},this.loop=function(){var e=this;this.firFocus.on("keydown",(function(n){if("keydown"==n.type&&9==n.keyCode&&n.shiftKey)return e.lastFocus.focus(),!1})),this.lastFocus.on("keydown",(function(n){if("keydown"==n.type&&9==n.keyCode&&n.shiftKey);else if(9==n.keyCode)return e.firFocus.focus(),!1}))}},e.Comment=function(){const n=this;n.env={testQueryString:"&user_id=silencethakar@gmail.com",commentType:0,commentTypeText:"",isLogin:!1,isLoginLecturer:"N",url:"",productId:"",lectureId:"",orderId:"",csrfName:"",csrfHash:"",$courseApplyBar:$(".course_apply_bar"),commentList:[],pageNum:0,totalCount:0,modifiedContent:{}},n.initViewData=function(e){const{commentType:t,productId:i,lectureId:l,orderId:o,csrfName:a,csrfHash:s,isLogin:c,isRecruit:r,isSeminar:d,isPreApply:m,isKDT:p}=e;1===t?(n.env.url="/shop/product/comment?product_id="+i,n.env.commentTypeText="후기"):1===r||1===d||1===m?(n.env.url=`/classes/comment?order_id=${o}&lecture_id=${l}`,n.env.commentTypeText="명이 벌써 신청했어요!"):2===t&&(n.env.url=`/classes/comment?order_id=${o}&lecture_id=${l}`,n.env.commentTypeText="댓글"),n.env.commentType=t,n.env.productId=i,n.env.lectureId=l,n.env.orderId=o,n.env.csrfName=a,n.env.csrfHash=s,n.env.isLogin=c,n.env.isRecruit=r,n.env.isSeminar=d,n.env.isPreApply=m,n.env.isKDT=p},n.initCommentWrap=function(e){let t="댓글";1===n.env.commentType?t="수강후기":2===n.env.commentType&&(t=1==n.env.isRecruit?"할인링크 받기":1==n.env.isSeminar?"세미나 신청하기":1==n.env.isPreApply?"신청하기":"댓글");let i="등록";1!==n.env.isRecruit&&1!==n.env.isSeminar&&1!==n.env.isPreApply||(i="신청");const l=$(e),o=$(`\n        <div class="header">\n          <span class="header_name">${t}</span>\n          ${n.env.isRecruit||n.env.isSeminar||n.env.isPreApply?`<span class="recruit_total_count">0 ${n.env.commentTypeText}</span>`:`<span class="total_count">0 ${n.env.commentTypeText}</span>`}\n        </div>\n      `);let a="글을 작성해 주세요.";a=1===n.env.isRecruit||1===n.env.isPreApply?"신청합니다. 열심히 해보겠습니다!":1===n.env.isSeminar?"OO월 OO일 OO시 신청합니다.":"글을 작성해 주세요.";const s=$(`\n        <div class="comment_write">\n          <form onsubmit="return false;">\n            <textarea placeholder="${a}" rows="1" id="inp_apply_area" ${n.env.isLogin?"":'inputmode="none"'}></textarea>\n            <div class="btn_wrap" style="display:none">\n            ${n.env.isRecruit||n.env.isSeminar||n.env.isPreApply?`<button class="cancle_btn">취소</button>\n              <button class="regist_btn">${i}</button>`:`<button class='camera_btn'><img src='/static/front/images/content/icon_imgupload.png' alt='이미지업로드'>사진첨부</button>\n              <button class="cancle_btn">취소</button>\n              <button class="regist_btn">${i}</button>`}\n              \n            </div>\n          </form>\n        </div>\n      `),c=s.find("textarea"),r=$('<div class="comment_list"></div>'),d=$('<input class="img_upload_comment" type="file" hidden>'),m=$(`\n        <div class="comment_more">\n          <button>${n.env.isRecruit||n.env.isSeminar||n.env.isPreApply?"":t} 더보기</button>\n        </div>\n      `),p=m.find("button");c.on({focus:()=>{1!==n.env.commentType||n.env.isLogin?(2!==n.env.commentType||n.env.isLogin||($("#inp_apply_area").attr("readonly","readonly"),lhsCommon.modal.open("login_popup",this)),$(window).width()>992?c.css("height","6rem"):(c.css("height","5rem"),n.env.$courseApplyBar.hide()),s.find(".btn_wrap").show()):location.href="/auth/signin?returnURL="+n.env.productId},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)}}),s.find(".camera_btn").on("click",e=>{e.preventDefault(),n.handleImgUpload(e)}),s.find(".cancle_btn").on("click",()=>{$(".img_upload_comment").val("");const e=s.find(".upload_img");e&&e.remove(),c.css("height","2rem"),c.val(""),s.find(".btn_wrap").hide()}),s.find(".regist_btn").on("click",lhsCommon.comment.addComment),p.on("click",lhsCommon.comment.getCommentList),l.append(o),l.append(s),l.append(r),l.append(m),l.append(d)},n.getCommentList=function(){$.ajax({url:""+n.env.url,type:"GET",data:{[n.env.csrfName]:n.env.csrfHash,pageNum:n.env.pageNum+1},dataType:"json",success:function(e){"success"===e.status?(n.env.commentList=[...n.env.commentList,...e.commentList],n.env.totalCount=e.totalCount,n.env.pageNum=1*e.pageNum,n.env.isLoginLecturer="Y"===e.loginedLecturer?"Y":"N",e.commentList.map(e=>$(".comment_list").append(n.getCommentView(e))),n.env.commentList.length===n.env.totalCount&&$(".comment_more").hide(),1===n.env.commentType&&$(window).width()>536&&$('.class_info .tab a[href="#review"]').html(`수강후기(${e.totalCount})`),n.env.totalCount=Number(e.totalCount),n.env.isRecruit||n.env.isSeminar||n.env.isPreApply?$(".comment_wrap .header .recruit_total_count").html(`${e.totalCount} ${n.env.commentTypeText}`):$(".comment_wrap .header .total_count").html(`${e.totalCount} ${n.env.commentTypeText}`)):alert(n.env.commentTypeText+"을 가져오는 데 실패했습니다.")},fail:function(e){console.log(e),alert(n.env.commentTypeText+"을 가져오는 데 실패했습니다.")}})},n.getCommentView=e=>{const{comment_id:t,my_comment:i,img_comment_file_id:l,img_comment_file:o,user_name:a,regist_date:s,content:c,reply_list:r,is_lecturer:d,lecturer_profile:m}=e,p=$(`\n        <div class="comment ${1===n.env.commentType?"is_review":""}" id=${t}>\n          ${i&&!(n.env.isRecruit||n.env.isSeminar||n.env.isPreApply)?"\n            <div class=\"more\">\n              <button class='comment_more_btn'>...</button>\n            </div>\n          ":""}\n\n          <div class="user">\n            ${d?`\n              <img src=${m} alt="강사 프로필">\n              `:'<img src="/static/front/images/content/img_class_profile.png" alt="프로필">'}\n            <div class="user_name">\n              <span>${a}</span>\n              ${d?'<span><img src="/static/front/images/content/img_class_lecturer_check.png" alt="강사 표시"></span>':""}\n            </div>\n            <div class="regist_date">${s}</div>\n          </div>\n\n          <div class='content'>\n            ${o?`\n              <div class='upload_img' id=${l}>\n                <img src=${o} alt='댓글 이미지'>\n              </div>\n              `:""}\n            <div class='text'>${c}</div>\n          </div>\n\n          ${n.env.isRecruit||n.env.isSeminar||n.env.isPreApply?"":`\n              <div class="reply_wrap">\n              ${"Y"===n.env.isLoginLecturer||2===n.env.commentType?'\n            <button class="reply_write_btn">\n              답글달기\n              <span class="arrow down"></span>\n            </button>\n\n            <div class="reply_write" hidden>\n              <form onsubmit="return false;">\n                <textarea placeholder="답글을 작성해주세요." rows="7"></textarea>\n                <div class="btn_wrap">\n                  <button class="camera_btn"><img src=\'/static/front/images/content/icon_imgupload.png\' alt=\'이미지업로드\'>사진첨부</button>\n                  <button class="cancle_btn">취소</button>\n                  <button class="regist_btn">등록</button>\n                </div>\n              </form>\n            </div>\n          ':""} \n                <div class="reply_list"></div>\n              </div>\n              `}\n        </div>\n      `),u=p.find(".reply_write_btn"),v=u.find(".arrow"),g=p.find(".reply_write"),f=g.find(".camera_btn"),h=g.find(".cancle_btn"),_=g.find(".regist_btn");n.handleImgOnClick(p),u.on("click",()=>{g.toggle(),v.toggleClass("up")}),f.on("click",e=>n.handleImgUpload(e)),h.on("click",()=>{const e=g.find(".upload_img");g.find("form textarea").val(""),e.length&&e.remove(),g.hide()}),_.on("click",n.addReply),this.initReplyListView(p,r);const y=p.find(".more button.comment_more_btn");return tippy(y[0],{placement:"bottom-end",content:'\n          <div class="menu">\n            <div class="sub_menu" onclick="lhsCommon.comment.modifyComment(this);">수정하기</div>\n            <div class="sub_menu" onclick="lhsCommon.comment.deleteComment(this);">삭제하기</div>\n          </div>\n        ',theme:"lhs_comment",trigger:"click",allowHTML:!0,interactive:!0,offset:[5,5],zIndex:1}),p},n.addComment=()=>{let e;if(e=1===n.env.isRecruit?"할인 링크":1===n.env.isSeminar?"세미나":1===n.env.isPreApply?"지금":confirm("댓글을 등록하시겠습니까?"),e){const e=$(".img_upload_comment"),t=$(".comment_write"),i=t.find("textarea"),l=t.find(".upload_img"),o=i.val(),a=e[0].files[0],s=new FormData;if(!o.trim())return void alert("댓글에 내용이 없습니다.");s.append([n.env.csrfName],n.env.csrfHash),s.append("content",o),s.append("img_comment_file",a),$.ajax({url:n.env.url+"&mode=new",type:"POST",data:s,dataType:"json",processData:!1,contentType:!1,success:t=>{if("success"===t.status)if(i.val(""),i.css("height","4rem"),a&&(e.val(""),l.remove()),n.env.totalCount=n.env.totalCount+1,n.env.isRecruit||n.env.isSeminar||n.env.isPreApply){if(1===n.env.isRecruit){if(eventFormDB.ref("fs_comment/"+(new Date).getTime()).set(t.result[0]),$(".comment_list").prepend(n.getCommentView(t.result[0])),$(".recruit_total_count").html(`${n.env.totalCount} ${n.env.commentTypeText}`),1!=confirm("할인링크 신청이 완료 되었습니다.\n지금 바로 할인링크로 접속 하시겠습니까?"))return;"52501"===n.env.lectureId||"52510"===n.env.lectureId?location.href="/monthly100?event=650117086de41":"52701"===n.env.lectureId?location.href="/youtubecamp?event=64b0b4cedf3a8":"52301"===n.env.lectureId||"52302"===n.env.lectureId?location.href="/fashioncamp/bootcamp?event=64e71d569bd0f":"52901"!==n.env.lectureId&&"52906"!==n.env.lectureId||(location.href="/sellercamp/bootcamp?event=65263d1d752b5")}else if(1===n.env.isSeminar){if(eventFormDB.ref("fs_comment/"+(new Date).getTime()).set(t.result[0]),$(".comment_list").prepend(n.getCommentView(t.result[0])),console.log("totalCount:",n.env.totalCount),console.log("commentTypeText:",n.env.commentTypeText),$(".recruit_total_count").html(`${n.env.totalCount} ${n.env.commentTypeText}`),"20801"===n.env.lectureId||"21201"===n.env.lectureId)return fbq("trackCustom","bd_seminar"),gtag("event","bd_seminar"),alert("세미나 신청이 완료되었습니다.\n접속 링크는 라이브 당일 카카오톡 또는 문자를 통해 개별 안내됩니다."),void(location.href="/ozcoding/bizdevcamp");if("20901"===n.env.lectureId)return fbq("trackCustom","uxui_seminar"),gtag("event","uxui_seminar"),alert("세미나 신청이 완료되었습니다.\n접속 링크는 라이브 당일 카카오톡 또는 문자를 통해 개별 안내됩니다."),void(location.href="/ozcoding/proddesigncamp");if("21001"===n.env.lectureId)return fbq("trackCustom","offfull_seminar"),gtag("event","offfull_seminar"),alert("세미나 신청이 완료되었습니다.\n접속 링크는 라이브 당일 카카오톡 또는 문자를 통해 개별 안내됩니다."),void(location.href="/ozcoding/serverlesscamp");if("21101"===n.env.lectureId)return fbq("trackCustom","codinggame_seminar"),gtag("event","codinggame_seminar"),void alert("세미나 신청이 완료되었습니다.\n접속 링크는 라이브 당일 카카오톡 또는 문자를 통해 개별 안내됩니다.");if("53101"===n.env.lectureId)return void alert("세미나 신청이 완료 되었습니다.");if("55501"===n.env.lectureId)return void alert("세미나 신청이 완료되었습니다.\n접속 링크는 라이브 당일 카카오톡 또는 문자를 통해 개별 안내됩니다.");if("55701"===n.env.lectureId){if(1!=confirm("신청이 완료되었습니다!\n라이프해킹스쿨 단톡방에서 세미나 정보를 받아보세요!"))return;location.href="https://open.kakao.com/o/gMa9YwXg"}else if("53201"===n.env.lectureId||"54203"===n.env.lectureId){if(1!=confirm("신청이 완료되었습니다!\n라이프해킹스쿨 단톡방에서 세미나 정보를 받아보세요!"))return;location.href="https://open.kakao.com/o/gDQlIJqg"}else{if(1!=confirm("세미나 신청이 완료 되었습니다.\n지금 바로 사전 질문을 작성해 보세요."))return;"52401"===n.env.lectureId||"52405"===n.env.lectureId?location.href="/monthly100/apply":"52601"===n.env.lectureId?location.href="/youtubecamp/apply":"52801"!==n.env.lectureId&&"52802"!==n.env.lectureId&&"52803"!==n.env.lectureId||(location.href="/fashioncamp/apply")}}else if(1===n.env.isPreApply)return eventFormDB.ref("fs_comment/"+(new Date).getTime()).set(t.result[0]),$(".comment_list").prepend(n.getCommentView(t.result[0])),$(".recruit_total_count").html(`${n.env.totalCount} ${n.env.commentTypeText}`),"53401"===n.env.lectureId?void alert("사전 신청이 완료 되었습니다."):"55901"===n.env.lectureId?(alert("얼리버드 신청이 완료되었습니다!\n할인 혜택을 확인하시고 최저가로 참여하세요!"),void(location.href="https://lifehacking.co.kr/auctioncamp/bootcamp?event=6734178f1b61b")):void alert("신청이 완료 되었습니다.")}else $(".comment_list").prepend(n.getCommentView(t.result[0])),$(".total_count").html(`${n.env.totalCount} 개의 ${n.env.commentTypeText}`);else 1===n.env.commentType?alert("수강생에 한해 작성하실 수 있습니다."):2===n.env.commentType&&(1===n.env.isRecruit||1===n.env.isSeminar||1===n.env.isPreApply?alert(t.description):alert("댓글 등록을 실패했습니다."))},fail:e=>{console.log(e),1===n.env.commentType?alert("수강생에 한해 작성하실 수 있습니다."):2===n.env.commentType&&alert("댓글 등록을 실패했습니다.")}})}},n.modifyComment=function(e){const t=$(".comment_wrap .img_upload_comment"),i=$(e).parents(".comment"),l=i.find(".more"),o=i.attr("id"),a=i.find("> .content"),s=a.find(".upload_img"),c=a.find(".text").html();n.env.modifiedContent[o]={prevImgId:s.attr("id"),prevImgSrc:s.find("img").attr("src"),prevText:c,modifiedText:c};const r=$(`\n        <div class="comment_modify">\n          <form onsubmit="return false;">\n            ${s.length?`\n              <div class='upload_img'>\n                ${s.html()}\n                <span class="close">\n                  <img src="/static/front/images/content/img_class_delete.png" alt="이미지 제거">\n                </span>\n              </div>\n            `:""}\n            <textarea rows="7">${c}</textarea>\n            <div class="btn_wrap">\n              <button class="camera_btn"></button>\n              <button class="cancle_btn">취소</button>\n              <button class="confirm_btn">확인</button>\n            </div>\n          </form>\n        </div>\n      `);r.find(".upload_img .close").on("click",e=>{$(e.target).closest(".upload_img").remove(),t.val("")}),r.find("textarea").on({focus:()=>{$(window).width()<992&&n.env.$courseApplyBar.hide()},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)},keyup:()=>{n.env.modifiedContent[o].modifiedText=event.target.value}}),r.find(".camera_btn").on("click",e=>{n.handleImgUpload(e)}),r.find(".cancle_btn").on("click",e=>lhsCommon.comment.modifyCommentCancle(e.target)),r.find(".confirm_btn").on("click",e=>lhsCommon.comment.modifyCommentConfirm(e.target)),l.hide(),a.replaceWith(r)},n.modifyCommentConfirm=function(e){const t=$(".img_upload_comment"),i=$(e).parents(".comment"),l=i.attr("id"),o=i.find(".more"),a=i.find(".comment_modify"),s=a.find(".upload_img"),c=n.env.modifiedContent[l].prevImgId||null,r=n.env.modifiedContent[l].modifiedText,d=t[0].files[0]||null,m=c&&!s.length||c&&d?"Y":"N",p=new FormData;if(r.trim()){p.append([n.env.csrfName],n.env.csrfHash),p.append("comment_id",l),p.append("content",r),p.append("img_comment_file_id",c),p.append("img_comment_file",d),p.append("img_delete",m);for(const[e,n]of p)console.log(e,n);$.ajax({url:n.env.url+"&mode=edit",type:"POST",data:p,dataType:"json",processData:!1,contentType:!1,success:function(e){console.log("modifyCommentConfirm res:",e);const{img_comment_file_id:i,img_comment_file:s,content:c}=e.result[0];if("success"===e.status){d&&t.val("");const e=$(`\n              <div class='content'>\n                ${s?`\n                  <div class='upload_img' id=${i}>\n                    <img src=${s} alt='댓글 이미지'>\n                  </div>\n                `:""}\n\n                <div class='text'>${c}</div>\n              </div>\n            `);s&&n.handleImgOnClick(e),a.replaceWith(e),o.show(),delete n.env.modifiedContent[l]}else alert(n.env.commentTypeText+" 수정하기를 실패했습니다.")},fail:function(e){console.log(e),alert(n.env.commentTypeText+" 수정하기를 실패했습니다.")}})}else alert(n.env.commentTypeText+"에 내용이 없습니다.")},n.modifyCommentCancle=function(e){const t=$(e).parents(".comment"),i=t.find(".more"),l=t.find(".comment_modify"),o=t.attr("id"),{prevImgId:a,prevImgSrc:s,prevText:c}=n.env.modifiedContent[o],r=$(`\n        <div class='content'>\n          ${s?`\n            <div class='upload_img' id=${a}>\n              <img src=${s} alt='댓글 이미지'>\n            </div>\n          `:""}\n\n          <div class='text'>${c}</div>\n        </div>\n      `);l.replaceWith(r),i.show(),delete n.env.modifiedContent[o]},n.deleteComment=function(e){if(confirm(`이 ${n.env.commentTypeText}을 삭제하시겠습니까?`)){const t=$(e).parents(".comment"),i=t.attr("id");$.ajax({url:n.env.url+"&mode=remove",type:"POST",data:{[n.env.csrfName]:n.env.csrfHash,comment_id:i},dataType:"json",success:function(e){"success"===e.status?(n.env.totalCount=n.env.totalCount-1,$(".total_count").html(`${n.env.totalCount}개의 ${n.env.commentTypeText}`),t.remove()):alert(n.env.commentTypeText+" 삭제하기를 실패했습니다.")},fail:function(e){console.log(e),alert(n.env.commentTypeText+" 삭제하기를 실패했습니다.")}})}},n.initReplyListView=(e,t=[])=>{const i=Array.isArray(t)?t:[],l=e.find(".reply_list");i.map(e=>{const t=n.getReplyView(e);l.append(t)})},n.getReplyView=e=>{const{comment_id:t,my_comment:i,img_comment_file_id:l,img_comment_file:o,user_name:a,regist_date:s,content:c,is_lecturer:r,lecturer_profile:d}=e,m=$(`\n        <div class="reply" id=${t}>\n          ${i?"\n            <div class=\"more\">\n              <button class='reply_more'>...</button>\n            </div>\n          ":""}\n\n          <div class="user">\n            ${r?` <img src=${d} alt="강사 프로필">\n              `:'<img src="/static/front/images/content/img_class_profile.png" alt="프로필">'}\n            <div class="user_name">\n              <span>${a}</span>\n              ${r?'<span><img src="/static/front/images/content/img_class_lecturer_check.png" alt="강사 표시"></span>':""}\n            </div>\n            <div class="regist_date">${s}</div>\n          </div>\n\n          <div class='content'>\n            ${o?`\n              <div class='upload_img' id=${l}>\n                <img src=${o} alt='댓글 이미지'>\n              </div>\n              `:""}\n            <div class='text'>${c}</div>\n          </div>\n        </div>\n      `);n.handleImgOnClick(m);const p=m.find(".more button.reply_more");return tippy(p[0],{placement:"bottom-end",content:'\n          <div class="menu">\n            <div class="sub_menu" onclick="lhsCommon.comment.modifyReply(this);">수정하기</div>\n            <div class="sub_menu" onclick="lhsCommon.comment.deleteReply(this);">삭제하기</div>\n          </div>\n        ',theme:"lhs_comment",trigger:"click",allowHTML:!0,interactive:!0,offset:[5,5],zIndex:1}),m},n.addReply=e=>{const t=$(".img_upload_comment"),i=$(e.target).parents(".comment"),l=$(e.target).parents(".reply_wrap"),o=l.find(".reply_write"),a=o.find("textarea"),s=l.find(".reply_list"),c=o.find(".upload_img"),r=i.attr("id"),d=a.val(),m=t[0].files[0];if(!d.trim())return void alert("답글에 내용이 없습니다.");const p=new FormData;p.append([n.env.csrfName],n.env.csrfHash),p.append("comment_id",r),p.append("content",d),p.append("img_comment_file",m),$.ajax({url:n.env.url+"&mode=reply",type:"POST",data:p,dataType:"json",processData:!1,contentType:!1,success:e=>{"success"===e.status?(o.toggle(),a.val(""),m&&(t.val(""),c.remove()),s.append(n.getReplyView(e.result[0]))):alert("답글 등록을 실패했습니다.")},fail:e=>{console.log(e),alert("답글 등록을 실패했습니다.")}})},n.modifyReply=e=>{const t=$(".img_upload_comment"),i=$(e).parents(".reply"),l=i.find(".more"),o=i.attr("id"),a=i.find(".content"),s=i.find(".upload_img"),c=a.find(".text").html();n.env.modifiedContent[o]={prevImgId:s.attr("id"),prevImgSrc:s.find("img").attr("src"),prevText:c,modifiedText:c};const r=$(`\n        <div class="reply_modify">\n          <form onsubmit="return false;">\n            ${s.length?`\n              <div class='upload_img'>\n                ${s.html()}\n                <span class="close">\n                  <img src="/static/front/images/content/img_class_delete.png" alt="이미지 제거">\n                </span>\n              </div>\n            `:""}\n            <textarea rows="4">${c}</textarea>\n            <div class="btn_wrap">\n              <button class="camera_btn"></button>\n              <button class="cancle_btn">취소</button>\n              <button class="confirm_btn">확인</button>\n            </div>\n          </form>\n        </div>\n      `);r.find(".upload_img .close").on("click",e=>{$(e.target).closest(".upload_img").remove(),t.val("")}),r.find("textarea").on({focus:()=>{$(window).width()<992&&n.env.$courseApplyBar.hide()},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)},keyup:()=>{n.env.modifiedContent[o].modifiedText=event.target.value}}),r.find(".camera_btn").on("click",e=>{e.preventDefault(),n.handleImgUpload(e)}),r.find(".cancle_btn").on("click",e=>lhsCommon.comment.modifyReplyCancle(e.target)),r.find(".confirm_btn").on("click",e=>lhsCommon.comment.modifyReplyConfirm(e.target)),l.hide(),a.replaceWith(r)},n.modifyReplyConfirm=e=>{const t=$(".img_upload_comment"),i=$(e).parents(".reply"),l=i.attr("id"),o=i.find(".more"),a=i.find(".reply_modify"),s=a.find(".upload_img"),c=n.env.modifiedContent[l].prevImgId||null,r=n.env.modifiedContent[l].modifiedText,d=t[0].files[0]||null,m=c&&!s.length||c&&d?"Y":"N",p=new FormData;r.trim()?(p.append([n.env.csrfName],n.env.csrfHash),p.append("comment_id",l),p.append("content",r),p.append("img_comment_file_id",c),p.append("img_comment_file",d),p.append("img_delete",m),$.ajax({url:n.env.url+"&mode=edit",type:"POST",data:p,dataType:"json",processData:!1,contentType:!1,success:function(e){const{img_comment_file_id:i,img_comment_file:s,content:c}=e.result[0];if("success"===e.status){d&&t.val("");const e=$(`\n              <div class='content'>\n                ${s?`\n                  <div class='upload_img' id=${i}>\n                    <img src=${s} alt='댓글 이미지'>\n                  </div>\n                `:""}\n\n                <div class='text'>${c}</div>\n              </div>\n            `);s&&n.handleImgOnClick(e),a.replaceWith(e),o.show(),delete n.env.modifiedContent[l]}else alert("답글 수정하기를 실패했습니다.")},fail:function(e){console.log(e),alert("답글 수정하기를 실패했습니다.")}})):alert("답글에 내용이 없습니다.")},n.modifyReplyCancle=e=>{const t=$(e).parents(".reply"),i=t.find(".more"),l=t.find(".reply_modify"),o=t.attr("id"),{prevImgId:a,prevImgSrc:s,prevText:c}=n.env.modifiedContent[o],r=$(`\n        <div class='content'>\n          ${s?`\n            <div class='upload_img' id=${a}>\n              <img src=${s} alt='댓글 이미지'>\n            </div>\n          `:""}\n\n          <div class='text'>${c}</div>\n        </div>\n      `);l.replaceWith(r),i.show(),delete n.env.modifiedContent[o]},n.deleteReply=e=>{if(confirm("이 답글을 삭제하시겠습니까?")){const t=$(e).parents(".reply"),i=t.attr("id");$.ajax({url:n.env.url+"&mode=remove",type:"POST",data:{[n.env.csrfName]:n.env.csrfHash,comment_id:i},dataType:"json",success:function(e){"success"===e.status?t.remove():alert("답글 삭제하기를 실패했습니다.")},fail:function(e){console.log(e),alert("답글 삭제하기를 실패했습니다.")}})}},n.handleImgOnClick=n=>{const t=$(n).find(".upload_img"),i=t.clone(),l=$("#imgModal");t.on("click",()=>{l.length?(l.find(".inner_popup").html(i),e.modal.open("imgModal",this)):alert("이미지 팝업이 존재하지 않습니다. 관리자에게 문의하세요.")})},n.handleImgUpload=e=>{console.log("handleImgUpload enter");const t=$(".img_upload_comment"),i=$(e.target).closest("form"),l=i.find(".upload_img");l.length&&l.remove(),t.off("change"),t.on("change",e=>n.handleImgUploadComplete(e,t,i)),t.val(""),console.log("1"),t.click(),console.log("2")},n.handleImgUploadComplete=(e,n,t)=>{console.log("handleImgUploadComplete");const i=e.target.files[0],l=new FileReader;i.type.match("image")?(l.onload=e=>{const i=$(`\n          <div class="upload_img">\n            <img src=${e.target.result}>\n            <span class="close">\n              <img src="/static/front/images/content/img_class_delete.png" alt="이미지 제거">\n            </span>\n          </div>\n        `);i.find(".close").on("click",()=>{i.remove(),n.val("")}),t.prepend(i)},l.onabort=e=>{alert("이미지 업로드를 실패했습니다."),console.log(e)},l.onerror=e=>{alert("이미지 업로드를 실패했습니다."),console.log(e)},l.readAsDataURL(i)):alert("이미지만 업로드 할 수 있습니다.")}},e.Challenge=function(){const n=this;n.env={challengeType:0,challengeTypeText:"",isLogin:!1,isLoginLecturer:"N",url:"",productId:"",lectureId:"",orderId:"",csrfName:"",csrfHash:"",isKDT:0,isKDC:0,isLogin:1,userId:"",authentication:"",$courseApplyBar:$(".course_apply_bar"),challengeList:[],pageNum:0,totalCount:0,modifiedContent:{challengeId:{prevImgId:"",prevImgSrc:"",prevText:"",modifiedText:""}}},n.resetPageNum=()=>n.env.pageNum=0,n.getChallengeNum=()=>{const e=String(n.env.missionId).slice(-2);return Number(e)},n.initViewData=function(e){const{challengeType:t,productId:i,missionId:l,orderId:o,challengeCompletion:a,csrfName:s,csrfHash:c,isKDT:r,isKDC:d,isLogin:m,userId:p,authentication:u}=e;n.env.url=`/classes/challenge?order_id=${o}&mission_id=${l}`,n.env.challengeTypeText="챌린지",n.env.challengeType=t,n.env.challengeCompletion=a,n.env.productId=i,n.env.missionId=l,n.env.orderId=o,n.env.csrfName=s,n.env.csrfHash=c,n.env.isKDT=r,n.env.isKDC=d,n.env.isLogin=m,n.env.userId=p,n.env.authentication=u},n.initChallengeWrap=function(e){const t=$(e),i=$(`\n        <div class="header">\n          <div>\n            <span class="header_name">제출하기</span>\n            <span class="total_count">0개의 ${n.env.challengeTypeText}</span>\n          </div>\n          <span class="challenge_num">#${n.getChallengeNum()}</span>\n        </div>\n      `),l=$(`\n        <div class="challenge_submit">\n        ${"N"===n.env.challengeCompletion?'\n          <div class="challenge_write">\n            <form onsubmit="return false;">\n              <textarea placeholder="글을 작성해 주세요." rows="1"></textarea>\n              <div class="btn_wrap">\n                <button class="camera_btn"><img src=\'/static/front/images/content/icon_imgupload.png\' alt=\'이미지업로드\'>사진첨부</button>\n                <button class="cancle_btn">취소</button>\n                <button class="regist_btn">등록</button>\n              </div>\n            </form>\n          </div>\n          <div class="challenge_warning">\n            <div class="flex">\n              <div class="warning_icon">\n                <img src=\'/static/front/images/content/warning_icon.png\' alt=\'warning_icon\'>\n              </div>\n              <div class="warning_text">\n                <b>작성한 내용이 미션 내용과 무관할 경우, 챌린지 수행으로 인정되지 않습니다.</b><br>\n                환급이 처리되지 않거나 환급받은 경우라도 추후 환수 조치 될 수 있습니다.\n              </div>\n            </div>\n          </div>\n        ':""}\n        </div>\n      `),o=$('<div class="temp_challenge_submit"></div>'),a=l.find("textarea"),s=$('<div class="challenge_list"></div>'),c=$('<div class="temp_challenge_list"></div>'),r=$('<input class="img_upload" type="file" hidden>'),d=$('\n        <div class="challenge_more">\n          <button disabled>제출하기 더보기</button>\n        </div>\n      '),m=d.find("button");a.on({focus:()=>{if(0===n.env.challengeType&&!n.env.isLogin)return console.log("로그인이 필요합니다."),void(location.href="/auth/signin?returnURL="+n.env.productId);$(window).width()>992?a.css("height","6rem"):(a.css("height","5rem"),n.env.$courseApplyBar.hide()),l.find(".btn_wrap").show()},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)}}),l.find(".camera_btn").on("click",e=>{n.handleImgUpload2(e)}),l.find(".cancle_btn").on("click",()=>{$(".img_upload").val("");const e=l.find(".upload_img");e&&e.remove(),a.css("height","2rem"),a.val(""),l.find(".btn_wrap").hide()}),l.find(".regist_btn").on("click",lhsCommon.challenge.addChallenge),m.on("click",()=>lhsCommon.challenge.addChallengeList(n.env.missionId)),t.append(i),t.append(l),t.append(o),t.append(s),t.append(d),t.append(c),t.append(r)},n.getChallengeList=function(t){n.resetPageNum(),$(".challenge_more").show(),n.env.pageNum+=1,$.ajax({url:""+n.env.url,type:"GET",data:{[n.env.csrfName]:n.env.csrfHash,pageNum:n.env.pageNum,mission_id:t},dataType:"json",success:function(i){if("success"===i.status){n.env.challengeList=i.challengeList,n.env.totalCount=i.totalCount,n.env.missionId=t,0===Object.keys(i.myChallenge).length?$(".challenge_submit").html('\n                <div class="challenge_write">\n                  <form onsubmit="return false;">\n                    <textarea placeholder="글을 작성해 주세요." rows="1"></textarea>\n                    <div class="btn_wrap">\n                      <button class="camera_btn"><img src=\'/static/front/images/content/icon_imgupload.png\' alt=\'이미지업로드\'>사진첨부</button>\n                      <button class="cancle_btn">취소</button>\n                      <button class="regist_btn">등록</button>\n                    </div>\n                  </form>\n                </div>\n                <div class="challenge_warning">\n                  <div class="flex">\n                    <div class="warning_icon">\n                      <img src=\'/static/front/images/content/warning_icon.png\' alt=\'warning_icon\'>\n                    </div>\n                    <div class="warning_text">\n                      <b>작성한 내용이 미션 내용과 무관할 경우, 챌린지 수행으로 인정되지 않습니다.</b><br>\n                      환급이 처리되지 않거나 환급받은 경우라도 추후 환수 조치 될 수 있습니다.\n                    </div>\n                  </div>\n                </div>\n              '):($(".temp_challenge_submit").append(n.getSubmittedMyChallengeView(i.myChallenge)),$(".challenge_submit").html($(".temp_challenge_submit > div")));const l=$(".challenge_submit"),o=l.find("textarea");o.on({focus:()=>{if(0===n.env.challengeType&&!n.env.isLogin)return console.log("로그인이 필요합니다."),void(location.href="/auth/signin?returnURL="+n.env.productId);console.log("[lhs.common]isKDC:",n.env.isKDC),console.log("[lhs.common]productId:",n.env.productId),console.log("[lhs.common]authentication:",e.field.payload.authentication),"1"!==n.env.isKDT&&1!==n.env.isKDC||0!==e.field.payload.authentication||(console.log("[강의수강화면] 번호 인증이 필요합니다."),lhsCommon.modal.open("number_popup",this)),$(window).width()>992||n.env.$courseApplyBar.hide(),l.find(".btn_wrap").show()},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)}}),l.find(".camera_btn").on("click",e=>{n.handleImgUpload2(e)}),l.find(".cancle_btn").on("click",()=>{$(".img_upload").val("");const e=l.find(".upload_img");e&&e.remove(),o.val(""),l.find(".btn_wrap").hide()}),l.find(".regist_btn").on("click",lhsCommon.challenge.addChallenge),n.env.challengeList.map(e=>$(".temp_challenge_list").append(n.getChallengeView(e))),$(".challenge_list").html($(".temp_challenge_list > div")),(i.hasMyChallenge&&n.env.totalCount<20||n.env.challengeList.length===n.env.totalCount)&&$(".challenge_more").hide(),0===n.env.challengeType&&$(window).width()>536&&$('.class_info .tab a[href="#review"]').html(`수강후기(${i.totalCount})`),$(".challenge_wrap .header .total_count").html(`${n.env.totalCount}개의 ${n.env.challengeTypeText}`),$(".challenge_wrap .header .challenge_num").html("#"+n.getChallengeNum())}else alert(n.env.challengeTypeText+"를 가져오는 데 실패했습니다.");console.log("currentMissionId",t),$(".challenge_more button").attr("disabled",!1)},fail:function(e){console.log(e),alert(n.env.challengeTypeText+"를 가져오는 데 실패했습니다.")}})},n.addChallengeList=function(e){$(".challenge_more button").attr("disabled",!0),n.env.pageNum+=1,$.ajax({url:""+n.env.url,type:"GET",data:{[n.env.csrfName]:n.env.csrfHash,pageNum:n.env.pageNum,mission_id:e},dataType:"json",success:function(t){if("success"===t.status){n.env.challengeList=t.challengeList,n.env.totalCount=t.totalCount,n.env.missionId=e,n.env.challengeList.map(e=>$(".challenge_list").append(n.getChallengeView(e)));const i=n.env.totalCount-t.hasMyChallenge;$(".challenge_list").children().length===i&&$(".challenge_more").hide(),0===n.env.challengeType&&$(window).width()>536&&$('.class_info .tab a[href="#review"]').html(`수강후기(${t.totalCount})`),$(".challenge_wrap .header .total_count").html(`${n.env.totalCount}개의 ${n.env.challengeTypeText}`)}else alert(n.env.challengeTypeText+"를 가져오는 데 실패했습니다.");$(".challenge_more button").attr("disabled",!1)},fail:function(e){console.log(e),alert(n.env.challengeTypeText+"를 가져오는 데 실패했습니다.")}})},n.env.canEvaluate=!0,n.getChallengeView=e=>{n.env.orderId;const{user_challenge_id:t,my_challenge:i,img_challenge_file_id:l,img_challenge_file:o,user_name:a,submit_date:s,submit_content:c,reply_list:r,is_lecturer:d,lecturer_profile:m,score:p}=e,u=$(`\n        <div class="challenge ${1===n.env.challengeType?"is_review":""}" id=${t}>\n          ${i?"\n            <div class=\"more\">\n              <button class='challenge_more_btn'>...</button>\n            </div>\n          ":""}\n\n          <div class="user">\n            ${d?`\n              <img src=${m} alt="강사 프로필">\n              `:'<img src="/static/front/images/content/img_class_profile.png" alt="프로필">'}\n            <div class="user_name">\n              <span>${a}</span>\n              ${d?'<span><img src="/static/front/images/content/img_class_lecturer_check.png" alt="강사 표시"></span>':""}\n            </div>\n            <div class="regist_date">${s}\n            ${p?`\n                <span class='score_line'>|</span><span class='score'>\n                  ${p}점\n                </span>\n                `:""}\n            </div> \n          </div>\n\n          <div class='content'>\n            ${o?`\n              <div class='upload_img' id=${l}>\n                <img src=${o} alt='댓글 이미지'>\n              </div>\n              `:""}\n            <div class='text'>${c}</div>\n          </div>\n\n          <div class="reply_wrap">\n            ${"Y"===n.env.isLoginLecturer||0===n.env.challengeType?`\n              <button class="reply_write_btn">\n                답글달기\n                <span class="arrow down"></span>\n              </button>\n\n              <div class="reply_write" hidden>\n                <form onsubmit="return false;">\n                  <textarea placeholder="답글을 작성해주세요." rows="7"></textarea>\n                  <div class="btn_wrap">\n                    <button class="camera_btn"><img src='/static/front/images/content/icon_imgupload.png' alt='이미지업로드'>사진첨부</button>\n                   ${n.env.canEvaluate?"<button class=\"evaluate_btn\"><img src='/static/front/images/content/icon_evaluate.png' alt='평가'>평가</button>":""}\n                    <button class="cancle_btn">취소</button>\n                    <button class="regist_btn">등록</button>\n                  </div>\n                </form>\n              </div>\n            `:""}\n\n              <div class="reply_list"></div>\n            </div>\n\n        </div>\n      `),v=u.find(".reply_write_btn"),g=v.find(".arrow"),f=u.find(".reply_write"),h=f.find(".camera_btn"),_=f.find(".evaluate_btn"),y=f.find(".cancle_btn"),b=f.find(".regist_btn");n.handleImgOnClick(u),v.on("click",()=>{f.toggle(),g.toggleClass("up")}),h.on("click",e=>n.handleImgUpload2(e)),n.env.canEvaluate&&_.on("click",e=>{const i=tippy(e.currentTarget,{content:'\n              <div class="evaluate_tooltip">\n                <div>\n                  <input type="text" class="evaluate_input" name="score" />점\n                </div>\n                <button class="evaluate_submit_btn">입력</button>\n              </div>\n            ',trigger:"manual",allowHTML:!0,interactive:!0,theme:"light",placement:"top",zIndex:1});i.show(),$("*[name=score]").focus(),setTimeout(()=>{const e=$(i.popper),l=e.find(".evaluate_input"),o=e.find(".evaluate_submit_btn"),a=u.find(".regist_date");l.on("input",()=>{const e=l.val();(!/^\d*$/.test(e)||e>100)&&(alert("0부터 100 사이의 숫자만 입력 가능합니다."),l.val(e.slice(0,-1)))});const s=()=>{const e=l.val();""===e||e<0||e>100?alert("0부터 100 사이의 숫자를 입력해 주세요."):$.ajax({url:"/classes/giveChallengeFeedback",type:"POST",data:{[n.env.csrfName]:n.env.csrfHash,user_challenge_id:t,score:e},success:n=>{"success"===n.status?(alert("점수가 성공적으로 입력되었습니다."),i.hide(),a.html(`<div class="regist_date">${n.submit_date}\n                    <span class="score_line">|</span><span class="score">\n                    ${e}점\n                    </span>\n                </div>`)):alert(n.error||"점수 입력에 실패했습니다.")},error:e=>{console.error(e),alert("점수 입력 중 오류가 발생했습니다.")}})};o.on("click",s),l.on("keypress",e=>{"Enter"===e.key&&(e.preventDefault(),s())})},10)}),y.on("click",()=>{const e=f.find(".upload_img");f.find("form textarea").val(""),e.length&&e.remove(),f.hide()}),b.on("click",n.addReply),this.initReplyChallengeListView(u,r);const C=u.find(".more button.challenge_more_btn");return tippy(C[0],{placement:"bottom-end",content:'\n          <div class="menu">\n            <div class="sub_menu" onclick="lhsCommon.challenge.modifyChallenge(this);">수정하기</div>\n            <div class="sub_menu" onclick="lhsCommon.challenge.deleteChallenge(this);">삭제하기</div>\n          </div>\n        ',theme:"lhs_challenge",trigger:"click",allowHTML:!0,interactive:!0,offset:[5,5],zIndex:1}),u},n.getSubmittedMyChallengeView=e=>{const{user_challenge_id:t,my_challenge:i,img_challenge_file_id:l,img_challenge_file:o,user_name:a,submit_date:s,submit_content:c,reply_list:r,is_lecturer:d,lecturer_profile:m}=e,p=$(`\n        <div class="challenge_mywriting">\n          <div class="challenge" id="${t}">\n            <div class="tit">※ 제출하신 챌린지는 챌린지 기간 내에 수정이 가능합니다. ※</div>\n            ${i?"\n              <div class=\"more\">\n                <button class='challenge_more_btn'>...</button>\n              </div>\n            ":""}\n\n            <div class="user">\n              ${d?`\n                <img src=${m} alt="강사 프로필">\n                `:'<img src="/static/front/images/content/img_class_profile.png" alt="프로필">'}\n              <div class="user_name">\n                <span>${a}</span>\n              </div>\n              <div class="regist_date">${s}</div>\n            </div>\n\n            <div class='content'>\n              ${o?`\n                <div class='upload_img' id=${l}>\n                  <img src=${o} alt='댓글 이미지'>\n                </div>\n                `:""}\n              <div class='text'>${c}</div>\n            </div>\n\n            <div class="reply_wrap">\n            ${"Y"===n.env.isLoginLecturer||0===n.env.challengeType?'\n              <button class="reply_write_btn">\n                답글달기\n                <span class="arrow down"></span>\n              </button>\n\n              <div class="reply_write" hidden>\n                <form onsubmit="return false;">\n                  <textarea placeholder="답글을 작성해주세요." rows="7"></textarea>\n                  <div class="btn_wrap">\n                    <button class="camera_btn"><img src=\'/static/front/images/content/icon_imgupload.png\' alt=\'이미지업로드\'>사진첨부</button>\n                    <button class="cancle_btn">취소</button>\n                    <button class="regist_btn">등록</button>\n                  </div>\n                </form>\n              </div>\n            ':""}\n\n              <div class="reply_list"></div>\n            </div>\n\n          </div>\n        </div>\n      `),u=p.find(".reply_write_btn"),v=u.find(".arrow"),g=p.find(".reply_write"),f=(g.find(".camera_btn"),g.find(".cancle_btn")),h=g.find(".regist_btn");n.handleImgOnClick(p),u.on("click",()=>{g.toggle(),v.toggleClass("up"),g.is(":visible")&&g.find(".btn_wrap").show()}),f.on("click",e=>{e.stopPropagation();const n=$(e.target).closest(".reply_write"),t=n.find(".btn_wrap");n.find("form textarea").val("");const i=n.find(".upload_img");i.length&&i.remove(),t.hide(),n.hide(),$challengeModify.is(":visible")||t.show()}),h.on("click",n.addReply),this.initReplyChallengeListView(p,r);const _=p.find(".more button.challenge_more_btn");return tippy(_[0],{placement:"bottom-end",content:'\n          <div class="menu">\n            <div class="sub_menu" onclick="lhsCommon.challenge.modifyChallenge(this);">수정하기</div>\n            \x3c!--<div class="sub_menu" onclick="lhsCommon.challenge.deleteChallenge(this);">삭제하기</div>--\x3e\n          </div>\n        ',theme:"lhs_challenge",trigger:"click",allowHTML:!0,interactive:!0,offset:[5,5],zIndex:1}),p},n.addChallenge=()=>{if(confirm(n.env.challengeTypeText+"를 등록하시겠습니까?")){const t=$(".img_upload"),i=$(".challenge_write"),l=i.find("textarea"),o=i.find(".upload_img"),a=l.val(),s=t[0].files[0],c=new FormData;if(!a.trim())return console.log(a),void alert(n.env.challengeTypeText+"에 내용이 없습니다.\n설명글을 작성해 주세요.");c.append([n.env.csrfName],n.env.csrfHash),c.append("content",a),c.append("img_challenge_file",s),$.ajax({url:`/classes/challenge?order_id=${n.env.orderId}&mission_id=${n.env.missionId}&mode=new`,type:"POST",data:c,dataType:"json",processData:!1,contentType:!1,success:i=>{if("success"===i.status){if(l.val(""),l.css("height","4rem"),s&&(t.val(""),o.remove()),$(".challenge_list").prepend(n.getChallengeView(i.result[0])),n.env.totalCount=n.env.totalCount+1,$(".total_count").html(`${n.env.totalCount}개의 ${n.env.challengeTypeText}`),1===n.env.isKDC&&1===e.field.payload.authentication){let e=n.getChallengeNum();"607"!==n.env.productId&&"611"!==n.env.productId&&"608"!==n.env.productId&&"609"!==n.env.productId||$.ajax({url:"/monitoring/insertScoreHistForKdcMonitoring",type:"post",dataType:"json",async:!1,data:{[n.env.csrfName]:n.env.csrfHash,order_id:n.env.orderId,lecture_id:n.env.lectureId,mission_id:n.env.missionId,courseAgentPk:n.env.productId,user_id:n.env.userId,evalType:"과제_"+e,evalCd:"03",chasi:e,isCopiedAnswer:"N"}}).done(e=>{console.log(e),e.status})}location.reload()}else alert(i.description),1===n.env.challengeType?alert("수강생에 한해 작성하실 수 있습니다."):2===n.env.challengeType&&alert(n.env.challengeTypeText+" 등록을 실패했습니다.")},fail:e=>{console.log(e),1===n.env.challengeType?alert("수강생에 한해 작성하실 수 있습니다."):2===n.env.challengeType&&alert(n.env.challengeTypeText+" 등록을 실패했습니다.")}})}},n.modifyChallenge=function(t){console.log("modifyChallenge elem: ",t);const i=$(".challenge_wrap .img_upload"),l=$(t).parents(".challenge"),o=l.find(".more"),a=l.attr("id"),s=l.find("> .content"),c=s.find(".upload_img"),r=s.find(".text").html();n.env.modifiedContent[a]={prevImgId:c.attr("id"),prevImgSrc:c.find("img").attr("src"),prevText:r,modifiedText:r},"1"!==n.env.isKDT&&"1"!==n.env.isKDC||0!==e.field.payload.authentication||(console.log("번호 인증이 필요합니다."),lhsCommon.modal.open("number_popup",this));const d=$(`\n        <div class="challenge_modify">\n          <form onsubmit="return false;">\n            ${c.length?`\n              <div class='upload_img'>\n                ${c.html()}\n                <span class="close">\n                  <img src="/static/front/images/content/img_class_delete.png" alt="이미지 제거">\n                </span>\n              </div>\n            `:""}\n            <textarea rows="4">${r}</textarea>\n            <div class="btn_wrap">\n            <button class="camera_btn"><img src='/static/front/images/content/icon_imgupload.png' alt='이미지업로드'>사진첨부</button>\n              <button class="cancle_btn">취소</button>\n              <button class="confirm_btn">확인</button>\n            </div>\n          </form>\n        </div>\n      `);d.find(".upload_img .close").on("click",e=>{$(e.target).closest(".upload_img").remove(),i.val("")}),d.find("textarea").on({focus:()=>{$(window).width()<992&&n.env.$courseApplyBar.hide()},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)},keyup:()=>{n.env.modifiedContent[a].modifiedText=event.target.value}}),d.find(".camera_btn").on("click",e=>{n.handleImgUpload2(e)}),d.find(".cancle_btn").on("click",e=>{lhsCommon.challenge.modifyChallengeCancle(e.target)}),d.find(".confirm_btn").on("click",e=>lhsCommon.challenge.modifyChallengeConfirm(e.target)),o.hide(),s.replaceWith(d)},n.modifyChallengeConfirm=function(e){console.log("modifyChallengeConfirm elem:",$(e).html());const t=$(".img_upload"),i=$(e).parents(".challenge"),l=i.attr("id"),o=i.find(".more"),a=i.find(".challenge_modify"),s=a.find(".upload_img"),c=n.env.modifiedContent[l].prevImgId||null,r=n.env.modifiedContent[l].modifiedText,d=t[0].files[0]||null;console.log("modifiedText:",r);const m=c&&!s.length||c&&d?"Y":"N",p=new FormData;if(r.trim()){p.append([n.env.csrfName],n.env.csrfHash),p.append("user_challenge_id",l),p.append("content",r),p.append("img_challenge_file_id",c),p.append("img_challenge_file",d),p.append("img_delete",m),console.log("modifyChallengeConfirm");for(const[e,n]of p)console.log(e,n);$.ajax({url:n.env.url+"&mode=edit",type:"POST",data:p,dataType:"json",processData:!1,contentType:!1,success:function(e){console.log("modify~~ success res:",e);const{img_challenge_file_id:i,img_challenge_file:s,submit_content:c}=e.result[0];if("success"===e.status){d&&t.val("");const e=$(`\n              <div class='content'>\n                ${s?`\n                  <div class='upload_img' id=${i}>\n                    <img src=${s} alt='댓글 이미지'>\n                  </div>\n                `:""}\n\n                <div class='text'>${c}</div>\n              </div>\n            `);s&&n.handleImgOnClick(e),a.replaceWith(e),o.show(),delete n.env.modifiedContent[l]}else alert(n.env.challengeTypeText+" 수정하기를 실패했습니다.")},fail:function(e){console.log(e),alert(n.env.challengeTypeText+" 수정하기를 실패했습니다.")}})}else alert(n.env.challengeTypeText+"에 내용이 없습니다.\n설명글을 작성해 주세요.")},n.modifyChallengeCancle=function(e){const t=$(e).parents(".challenge"),i=t.find(".more"),l=t.find(".challenge_modify"),o=t.attr("id"),{prevImgId:a,prevImgSrc:s,prevText:c}=n.env.modifiedContent[o],r=$(`\n        <div class='content'>\n          ${s?`\n            <div class='upload_img' id=${a}>\n              <img src=${s} alt='댓글 이미지'>\n            </div>\n          `:""}\n\n          <div class='text'>${c}</div>\n        </div>\n      `);l.replaceWith(r),i.show(),delete n.env.modifiedContent[o]},n.deleteChallenge=function(e){if(confirm(`이 ${n.env.challengeTypeText}를 삭제하시겠습니까?`)){const t=$(e).parents(".challenge"),i=t.attr("id");$.ajax({url:n.env.url+"&mode=remove",type:"POST",data:{[n.env.csrfName]:n.env.csrfHash,user_challenge_id:i},dataType:"json",success:function(e){"success"===e.status?(n.env.totalCount=n.env.totalCount-1,$(".total_count").html(`${n.env.totalCount}개의 ${n.env.challengeTypeText}`),t.remove(),location.reload()):alert(n.env.challengeTypeText+" 삭제하기를 실패했습니다.")},fail:function(e){console.log(e),alert(n.env.challengeTypeText+" 삭제하기를 실패했습니다.")}})}},n.initReplyChallengeListView=(e,t=[])=>{const i=Array.isArray(t)?t:[],l=e.find(".reply_list");i.map(e=>{const t=n.getReplyChallengeView(e);l.append(t)})},n.getReplyChallengeView=e=>{const{user_challenge_id:t,my_challenge:i,img_challenge_file_id:l,img_challenge_file:o,user_name:a,submit_date:s,submit_content:c,is_lecturer:r,lecturer_profile:d}=e,m=$(`\n        <div class="reply" id=${t}>\n          ${i?"\n            <div class=\"more\">\n              <button class='reply_more'>...</button>\n            </div>\n          ":""}\n\n          <div class="user">\n            ${r?` <img src=${d} alt="강사 프로필">\n              `:'<img src="/static/front/images/content/img_class_profile.png" alt="프로필">'}\n            <div class="user_name">\n              <span>${a}</span>\n              ${r?'<span><img src="/static/front/images/content/img_class_lecturer_check.png" alt="강사 표시"></span>':""}\n            </div>\n            <div class="regist_date">${s}</div>\n          </div>\n\n          <div class='content'>\n            ${o?`\n              <div class='upload_img' id=${l}>\n                <img src=${o} alt='댓글 이미지'>\n              </div>\n              `:""}\n            <div class='text'>${c}</div>\n          </div>\n        </div>\n      `);n.handleImgOnClick(m);const p=m.find(".more button.reply_more");return tippy(p[0],{placement:"bottom-end",content:'\n          <div class="menu">\n            <div class="sub_menu" onclick="lhsCommon.challenge.modifyReply(this);">수정하기</div>\n            <div class="sub_menu" onclick="lhsCommon.challenge.deleteReply(this);">삭제하기</div>\n          </div>\n        ',theme:"lhs_challenge",trigger:"click",allowHTML:!0,interactive:!0,offset:[5,5],zIndex:1}),m},n.addReply=e=>{const t=$(".img_upload"),i=$(e.target).parents(".challenge"),l=$(e.target).parents(".reply_wrap"),o=l.find(".reply_write"),a=o.find("textarea"),s=l.find(".reply_list"),c=o.find(".upload_img"),r=i.attr("id"),d=a.val(),m=t[0].files[0];if(!d.trim())return void alert("답글에 내용이 없습니다.");const p=new FormData;p.append([n.env.csrfName],n.env.csrfHash),p.append("user_challenge_id",r),p.append("content",d),p.append("img_challenge_file",m),$.ajax({url:`/classes/challenge?order_id=${n.env.orderId}&mission_id=${n.env.missionId}&mode=reply`,type:"POST",data:p,dataType:"json",processData:!1,contentType:!1,success:e=>{"success"===e.status?(o.toggle(),a.val(""),m&&(t.val(""),c.remove()),console.log("res.result[0]:",e.result[0]),s.append(n.getReplyChallengeView(e.result[0]))):alert("답글 등록을 실패했습니다.")},fail:e=>{console.log(e),alert("답글 등록을 실패했습니다.")}})},n.modifyReply=e=>{const t=$(".img_upload"),i=$(e).parents(".reply"),l=i.find(".more"),o=i.attr("id"),a=i.find(".content"),s=i.find(".upload_img"),c=a.find(".text").html();n.env.modifiedContent[o]={prevImgId:s.attr("id"),prevImgSrc:s.find("img").attr("src"),prevText:c,modifiedText:c};const r=$(`\n        <div class="reply_modify">\n          <form onsubmit="return false;">\n            ${s.length?`\n              <div class='upload_img'>\n                ${s.html()}\n                <span class="close">\n                  <img src="/static/front/images/content/img_class_delete.png" alt="이미지 제거">\n                </span>\n              </div>\n            `:""}\n            <textarea rows="4">${c}</textarea>\n            <div class="btn_wrap">\n              <button class="camera_btn"></button>\n              <button class="cancle_btn">취소</button>\n              <button class="confirm_btn">확인</button>\n            </div>\n          </form>\n        </div>\n      `);r.find(".upload_img .close").on("click",e=>{$(e.target).closest(".upload_img").remove(),t.val("")}),r.find("textarea").on({focus:()=>{$(window).width()<992&&n.env.$courseApplyBar.hide()},focusout:()=>{$(window).width()<992&&n.env.$courseApplyBar.delay(500).show(0)},keyup:()=>{n.env.modifiedContent[o].modifiedText=event.target.value}}),r.find(".camera_btn").on("click",e=>{n.handleImgUpload2(e)}),r.find(".cancle_btn").on("click",e=>lhsCommon.challenge.modifyReplyCancle(e.target)),r.find(".confirm_btn").on("click",e=>lhsCommon.challenge.modifyReplyConfirm(e.target)),l.hide(),a.replaceWith(r)},n.modifyReplyConfirm=e=>{const t=$(".img_upload"),i=$(e).parents(".reply"),l=i.attr("id"),o=i.find(".more"),a=i.find(".reply_modify"),s=a.find(".upload_img"),c=n.env.modifiedContent[l].prevImgId||null,r=n.env.modifiedContent[l].modifiedText,d=t[0].files[0]||null,m=c&&!s.length||c&&d?"Y":"N",p=new FormData;r.trim()?(p.append([n.env.csrfName],n.env.csrfHash),p.append("user_challenge_id",l),p.append("content",r),p.append("img_challenge_file_id",c),p.append("img_challenge_file",d),p.append("img_delete",m),$.ajax({url:n.env.url+"&mode=edit",type:"POST",data:p,dataType:"json",processData:!1,contentType:!1,success:function(e){const{img_challenge_file_id:i,img_challenge_file:s,submit_content:c}=e.result[0];if("success"===e.status){d&&t.val("");const e=$(`\n              <div class='content'>\n                ${s?`\n                  <div class='upload_img' id=${i}>\n                    <img src=${s} alt='댓글 이미지'>\n                  </div>\n                `:""}\n\n                <div class='text'>${c}</div>\n              </div>\n            `);s&&n.handleImgOnClick(e),a.replaceWith(e),o.show(),delete n.env.modifiedContent[l]}else alert("답글 수정하기를 실패했습니다.")},fail:function(e){console.log(e),alert("답글 수정하기를 실패했습니다.")}})):alert("답글에 내용이 없습니다.")},n.modifyReplyCancle=e=>{const t=$(e).parents(".reply"),i=t.find(".more"),l=t.find(".reply_modify"),o=t.attr("id"),{prevImgId:a,prevImgSrc:s,prevText:c}=n.env.modifiedContent[o],r=$(`\n        <div class='content'>\n          ${s?`\n            <div class='upload_img' id=${a}>\n              <img src=${s} alt='댓글 이미지'>\n            </div>\n          `:""}\n\n          <div class='text'>${c}</div>\n        </div>\n      `);l.replaceWith(r),i.show(),delete n.env.modifiedContent[o]},n.deleteReply=e=>{if(confirm("이 답글을 삭제하시겠습니까?")){const t=$(e).parents(".reply"),i=t.attr("id");$.ajax({url:n.env.url+"&mode=remove",type:"POST",data:{[n.env.csrfName]:n.env.csrfHash,user_challenge_id:i},dataType:"json",success:function(e){"success"===e.status?t.remove():alert("답글 삭제하기를 실패했습니다.")},fail:function(e){console.log(e),alert("답글 삭제하기를 실패했습니다.")}})}},n.handleImgOnClick=n=>{const t=$(n).find(".upload_img"),i=t.clone(),l=$("#imgModal");t.on("click",()=>{l.length?(l.find(".inner_popup").html(i),e.modal.open("imgModal",this)):alert("이미지 팝업이 존재하지 않습니다. 관리자에게 문의하세요.")})},n.handleImgUpload2=e=>{console.log("handleImgUpload2 called");const t=$(".img_upload"),i=$(e.target).closest("form"),l=i.find(".upload_img");l.length&&l.remove(),t.off("change"),t.on("change",e=>{console.log("Image input change event triggered"),n.handleImgUploadComplete2(e,t,i)}),t.val(""),t.click()},n.handleImgUploadComplete2=(e,n,t)=>{console.log("handleImgUploadComplete2 called");const i=e.target.files[0],l=new FileReader;i.type.match("image")?(l.onload=e=>{const i=$(`\n          <div class="upload_img">\n            <img src=${e.target.result}>\n            <span class="close">\n              <img src="/static/front/images/content/img_class_delete.png" alt="이미지 제거">\n            </span>\n          </div>\n        `);i.find(".close").on("click",()=>{i.remove(),n.val("")}),t.prepend(i)},l.onabort=e=>{alert("이미지 업로드를 실패했습니다."),console.log("File read aborted",e)},l.onerror=e=>{alert("이미지 업로드를 실패했습니다."),console.log("File read error",e)},l.readAsDataURL(i)):alert("이미지만 업로드 할 수 있습니다.")}},e.tootip=function(){$(".list_curriculum li > a").on({focus:function(){$(".tooltip").hide(),$(this).siblings().show()}})},e.tab=function(){$(".cont_tab").eq(0).show(),$(".tabs .comm_tab a").eq(0).addClass("tab_on"),$(".tabs .comm_tab a").click((function(){$(".tabs .comm_tab a").removeClass("tab_on"),$(this).addClass("tab_on");var e=$(this).index();$(".cont_tab").hide(),$(".cont_tab").eq(e).fadeIn()}))},e.fullMenu=function(){$(".menu_all .list_menu").on({"mouseenter focusin":function(){$(this).addClass("on")},"mouseleave focusout":function(){$(this).removeClass("on")}})},e.likeEvt=function(n,t){$(".like_btn").on("click",(function(i){const l=$(i.currentTarget);i.stopPropagation(),i.preventDefault();var o=e.field.payload.productId;if(!e.field.isLogin)return alert("로그인이 필요합니다."),void(location.href=o?"/auth/signin?returnURL="+o:"/auth/signin");l.hasClass("clicked")?$.ajax({url:n,type:"delete",dataType:"json",data:{csrf_token:e.field.csrf,url:t,product_id:l.attr("id")}}).done((function(e){console.log(e),"main"==l.data("type")&&l.html('<img src="/static/front/images/main/heart.svg" alt="">'),l.removeClass("clicked"),l.children(".clicked_img").hide(),l.children(".unclicked_img").show(),l.children(".like").html("♡"),console.log("#like-"+l.attr("id")),$("#like-"+l.attr("id")).html(e.like_count)})).fail((function(e){alert("강의 찜하기 취소를 실패했습니다."),console.log(e)})):$.ajax({url:n,type:"post",dataType:"json",data:{csrf_token:e.field.csrf,url:t,product_id:l.attr("id")}}).done((function(e){console.log(e),"main"==l.data("type")&&l.html('<img src="/static/front/images/main/heart_color.svg" alt="">'),l.addClass("clicked"),l.children(".clicked_img").show(),l.children(".unclicked_img").hide(),l.children(".like").html("♥"),$("#like-"+l.attr("id")).html(e.like_count),Snackbar.show({text:"이 클래스에 대한 알림을 보내드립니다.",pos:"bottom-center",duration:1500,showAction:!1,backgroundColor:"#222",textColor:"#fff",customClass:"custom_snackbar"})})).fail((function(e){alert("강의 찜하기를 실패했습니다."),console.log(e)}))}))},e.likeEvt2=function(n,t,i,l){$(".like_btn").on("click",(function(o){const a=$(o.currentTarget);o.stopPropagation(),o.preventDefault();var s=e.field.payload.productId;if(!e.field.isLogin)return alert("로그인이 필요합니다."),void(s?location.href="/auth/signin?returnURL="+s:lhsCommon.modal.open("login_popup",this));a.hasClass("clicked")?$.ajax({url:n,type:"delete",dataType:"json",data:{csrf_token:e.field.csrf,url:t,product_id:a.attr("id")}}).done((function(e){console.log(e),a.html(i),a.removeClass("clicked"),$("#like-"+a.attr("id")).html(e.like_count)})).fail((function(e){alert("강의 찜하기 취소를 실패했습니다."),console.log(e)})):$.ajax({url:n,type:"post",dataType:"json",data:{csrf_token:e.field.csrf,url:t,product_id:a.attr("id")}}).done((function(e){console.log(e),a.html(l),a.addClass("clicked"),$("#like-"+a.attr("id")).html(e.like_count),Snackbar.show({text:"이 클래스에 대한 알림을 보내드립니다.",pos:"bottom-center",duration:1500,showAction:!1,backgroundColor:"#222",textColor:"#fff",customClass:"custom_snackbar"})})).fail((function(e){alert("강의 찜하기를 실패했습니다."),console.log(e)}))}))},e.displayFloatingBtnKakao=function(){const e=document.querySelector("#floating_btn_kakao");["/mbti","/classes/view","/mypage/classList","/cauly/startupcamp","/cauly/startupcamp/apply","/cauly/startupcamp/apply/success","/cauly/bizdevcamp","/cauly/bizdevcamp/apply","/cauly/bizdevcamp/apply/success","/cauly/proddesigncamp","/cauly/proddesigncamp/apply","/cauly/proddesigncamp/apply/success"].includes(location.pathname)||(e.style.display="block")},e.init=(e.displayFloatingBtnKakao(),e.fullMenu(),e.resizer(),window.navi=e.navi(),e.tootip(),e.modal=new e.Modal,e.comment=new e.Comment,void(e.challenge=new e.Challenge))}const lhsCommon=new LhsCommon;